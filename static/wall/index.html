<!DOCTYPE html><html><head><meta charset="utf-8"><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-163606647-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163606647-1');
</script>
<link href="https://fonts.googleapis.com/css?family=Noto+Sans+TC:300,400,500,700|Roboto:300,500&amp;display=swap" rel="stylesheet"><link rel="stylesheet" type="text/css" href="/assets/lib/bootstrap/4.3.1/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldui/ldui.min.css"><link rel="stylesheet" type="text/css" href="/css/index.css"><style type="text/css">body {
  background: #ccc !important;
}
</style></head><body><div class="ldld full ld running z-fixed"></div><div class="card shadow-lg position-absolute border-0 d-none bg-cover" id="sample" style="width:430px;height:300px;max-width:90%;max-height:90%;overflow:scroll;background-position:center top"><div class="card-body" style="background:rgba(255,255,255,.5)"><div class="font-weight-bold mb-4 text-lg" ld="name"></div><p ld="description"></p></div></div><div id="container"></div><script type="text/javascript" src="/js/pack/vendor.min.js"></script><script type="text/javascript" src="/js/pack/base.min.js"></script><script>// Generated by LiveScript 1.3.0
var ldld, lc, sample, container, aniIn, cards, tbr, pos, handler, condolences;
ldld = new ldLoader({
  root: ".ldld.full.ld"
});
lc = {
  zidx: 1,
  pidx: 0,
  cidx: 0,
  cs: []
};
sample = ld$.find('#sample', 0);
container = ld$.find('#container', 0);
aniIn = "ld-float-btt-in";
cards = [];
tbr = [];
pos = [[10, 10], [60, 10], [65, 55], [10, 55], [25, 35], [46, 45], [42, 10]];
handler = function(t){
  var n, ref$, w, h, c, box, px, py, i$, i;
  if (lc.cs.length && (!cards.length || t > (cards[cards.length - 1] || {}).time + 5000 + Math.random() * 3000)) {
    cards.push(n = sample.cloneNode(true));
    n.removeAttribute('id');
    ref$ = [window.innerWidth, window.innerHeight], w = ref$[0], h = ref$[1];
    c = (lc.cs || [])[lc.cidx];
    lc.cidx = ((lc.cidx || 0) + 1) % ((lc.cs || (lc.cs = [])).length || 1);
    if (lc.cidx === 0) {
      condolences.fetch();
    }
    if (c) {
      n.time = t;
      n.life = 30000 + Math.random() * 30000;
      ld$.find(n, '[ld=name]', 0).innerText = c.source;
      ld$.find(n, '[ld=description]', 0).innerText = c.content;
      n.classList.add('ld', aniIn);
      box = {
        width: Math.min(430, w),
        height: Math.min(300, h)
      };
      px = (Math.random() * 20 - 10 + pos[lc.pidx][0]) * w / 100;
      py = (Math.random() * 20 - 10 + pos[lc.pidx][1]) * h / 100;
      if (px < 10) {
        px = 10;
      }
      if (py < 10) {
        py = 10;
      }
      if (px + box.width > w - 10) {
        px = w - box.width - 10;
      }
      if (py + box.height > h - 10) {
        py = h - box.height - 10;
      }
      n.style.left = px + "px";
      n.style.top = py + "px";
      lc.pidx = (lc.pidx + 1) % pos.length;
      n.style.zIndex = lc.zidx++;
      if (c.image) {
        n.style.backgroundImage = "url(/assets/uploads/" + c.key + ".png)";
      }
      n.classList.remove('d-none');
      container.appendChild(n);
    }
  }
  for (i$ = cards.length - 1; i$ >= 0; --i$) {
    i = i$;
    c = cards[i];
    if (c.time + c.life > t) {
      continue;
    }
    c.classList.add('ld-fade-out');
    c.classList.remove(aniIn);
    cards.splice(i, 1);
    tbr.push(c);
  }
  for (i$ = tbr.length - 1; i$ >= 0; --i$) {
    i = i$;
    c = tbr[i];
    if (c.time + c.life + 1000 > t) {
      continue;
    }
    if (c.parentNode) {
      c.parentNode.removeChild(c);
    }
    tbr.splice(i, 1);
  }
  return requestAnimationFrame(function(it){
    return handler(it);
  });
};
condolences = new ldPage({
  limit: 300,
  host: window,
  fetch: function(){
    return ld$.fetch('/d/condolence', {
      method: 'GET'
    }, {
      type: 'json',
      params: {
        offset: this.offset
      }
    }).then(function(list){
      list.map(function(it){
        return it.len = (it.content || '').length;
      });
      list.sort(function(a, b){
        var d;
        d = b.len - a.len;
        if (d === 0) {
          return 0;
        }
        if (Math.random() > 1 / (1 + Math.exp(-d))) {
          return -1;
        } else {
          return 1;
        }
      });
      ldld.off();
      lc.cs = list.concat(lc.cs || []);
      lc.cidx = 0;
      return list;
    });
  }
});
condolences.fetch();
requestAnimationFrame(function(it){
  return handler(it);
});</script></body></html>