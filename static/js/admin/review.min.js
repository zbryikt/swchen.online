ldc.register("admin",["loader","notify"],function(n){var e,t,i,d,r;return e=n.loader,t=n.notify,i={list:[]},d=new ldView({initRender:!1,root:"[ld-scope=admin]",action:{click:{accept:function(n){return n.node,r("accept")},reject:function(n){return n.node,r("reject")},pending:function(n){return n.node,r("pending")}}},handler:{item:{list:function(){return i.list},action:{click:function(n){var d,r,o,c,l;if(d=n.node,r=n.data,o=n.evt,(c=o.target)&&c.classList&&c.classList.contains("btn"))return e.on(),l=c.getAttribute("ld"),ld$.fetch("/d/condolence/"+r.key+"/verify",{method:"POST"},{type:"json",json:{verified:"ok"===l}}).finally(function(){return e.off()}).then(function(){return t.send("success","saved."),d.parentNode.removeChild(d),i.list.splice(i.list.indexOf(r),1)}).catch(function(){return t.send("error","failed to save")})}},handler:function(n){var e,t;if(e=n.node,t=n.data,ld$.find(e,"[ld=source]",0).innerText=t.source||"",ld$.find(e,"[ld=social]",0).innerText=t.social||"",ld$.find(e,"[ld=content]",0).innerText=t.content||"",ld$.find(e,"[ld=contact]",0).innerText=t.contact||"",ld$.find(e,"[ld=publish]",0).innerText=t.publish||"",t.image)return ld$.find(e,"[ld=image]",0).setAttribute("src","/assets/uploads/"+t.key+".png")}}}}),(r=function(n){var e;return e=+(ld$.find("[ld=offset]",0).value||0),ld$.fetch("/d/condolence/admin",{method:"GET"},{type:"json",params:{offset:e,verified:n}}).then(function(n){return i.list=n,d.render()})})("pending")}),ldc.app("admin");